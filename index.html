<!DOCTYPE html>
<html>
<head>
	<title>PostMessage Toolbox Example</title>

	<style>
		html, body {
			width: 282px;
			margin: 0;
			padding: 0;
		}
	</style>
</head>
<body>
	<h1>Toolbox</h1>

	<button onclick="replace()">Replace string</button>

	<script type="text/javascript">
		var message = null;

		window.onload = function() {
			window.parent.postMessage('toolboxReady', '*');
		}

		window.addEventListener('message', receiveMessage, false);

		function receiveMessage(event) {
			try {
				var json = JSON.parse(event.data);
			} catch(e) {
				return console.error("Unknown message", e);
			}

			message = json;
		}

		function replace() {
			if (!message) return;

			var templateString = JSON.stringify(message.elementJson.originalRoot);

			templateString = templateString.replace(/Double click to edit/g, "REPLACED");

			window.parent.postMessage(JSON.stringify({
				_dynId: message._dynId,
				action: "setProps",
				props: {
					root: JSON.parse(templateString)
				}
			}), '*');
		}
	</script>
</body>
</html>